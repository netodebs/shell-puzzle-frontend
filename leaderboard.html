<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Shell Booth Puzzle Challenge â€” Leaderboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800;900&display=swap" rel="stylesheet"/>

<style>
:root{
  /* â†™ï¸ Set these to your hosted image URLs if needed */
  --bg-img: url("https://www.ripmark.com.ng/wp-content/uploads/2025/11/Gemini_Generated_Image_5g2uag5g2uag5g2u-1.png");   /* full-screen background */
  --winner-bg: url("https://www.ripmark.com.ng/wp-content/uploads/2025/11/Gemini_Generated_Image_sl2iwvsl2iwvsl2i.png"); /* winner card background */

  --shell-yellow:#FFD700;
  --shell-red:#E30613;     /* brighter Shell red */
  --shell-red-dark:#7A0019;/* deep burgundy */
  --muted:#98a8be;
  --card-bg:linear-gradient(180deg,rgba(227,6,19,0.92),rgba(122,0,25,0.92));
}
html,body{height:100%;margin:0;font-family:Inter,system-ui,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:#fff;overflow:hidden}
body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}

/* ===== Pan/â€œKen Burnsâ€ background image ===== */
.bg-pan{
  position:fixed;inset:0;z-index:-2;pointer-events:none;
  background-image:var(--bg-img);
  background-size:cover;background-position:center;
  transform-origin:center;
  animation:kenburns 28s ease-in-out infinite alternate;
  filter:saturate(1.05) brightness(0.95);
}
@keyframes kenburns{
  0%{transform:scale(1) translate3d(0,0,0)}
  50%{transform:scale(1.06) translate3d(1.5%, -1.5%, 0)}
  100%{transform:scale(1.1) translate3d(-2%, 2%, 0)}
}

/* Ambient golden flares (subtle, over image) */
.bg-ambient{position:fixed;inset:0;z-index:-1;pointer-events:none;
  background:
    radial-gradient(1000px 700px at 15% 20%,rgba(255,215,0,0.10),transparent 55%),
    radial-gradient(900px 600px at 85% 80%,rgba(255,235,150,0.08),transparent 60%),
    radial-gradient(600px 400px at 50% 50%,rgba(255,255,255,0.04),transparent 60%);
  mix-blend-mode:screen;animation:ambientMove 18s linear infinite;opacity:.95}
@keyframes ambientMove{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}

main{position:relative;z-index:30;max-width:1800px;margin:18px auto;padding:18px}
h1{font-weight:900;font-size:34px;margin:0}
.live-badge{background:var(--shell-yellow);color:var(--shell-red);padding:6px 10px;border-radius:8px;margin-left:10px;font-weight:900;animation:livePulse 1.4s infinite}
@keyframes livePulse{0%,100%{opacity:1}50%{opacity:.6}}
.last-updated{color:#fff;opacity:.9;font-size:.95rem;margin-top:6px}

/* ====== Podium ====== */
#podiumContainer{display:flex;align-items:flex-end;justify-content:center;gap:36px;margin-top:60px}
.podium-card{
  background:var(--card-bg);border-radius:18px;padding:24px;text-align:center;
  box-shadow:0 0 40px rgba(255,215,0,0.25);border:1px solid rgba(255,215,0,0.25);
  position:relative;overflow:hidden
}

/* Winner card gets branded background image via ::before */
#rank-1-card::before{
  content:"";position:absolute;inset:0;z-index:0;
  background-image:var(--winner-bg);background-size:cover;background-position:center;
  filter:saturate(1.05) brightness(0.8);
  opacity:.28; /* gentle, keeps text readable */
}
#rank-1-card>*{position:relative;z-index:1}

#rank-1-card{
  width:52%;transform:translateY(-10%);
  border:2px solid rgba(255,215,0,0.45);
  box-shadow:0 0 80px rgba(255,215,0,0.45)
}
#rank-1-card.gold-pulse{animation:goldPulse 2.2s ease-in-out infinite}
@keyframes goldPulse{
  0%{box-shadow:0 0 40px rgba(255,215,0,0.35)}
  50%{box-shadow:0 0 90px rgba(255,215,0,0.65)}
  100%{box-shadow:0 0 40px rgba(255,215,0,0.35)}
}
#rank-2-card,#rank-3-card{width:28%;transform:translateY(8%)}
.gift-box-img{width:220px;height:auto;margin:0 auto 10px;filter:drop-shadow(0 0 36px rgba(255,215,0,0.5));animation:boxGlow 2.5s ease-in-out infinite alternate;border-radius:10px}
@keyframes boxGlow{0%{transform:scale(1)}100%{transform:scale(1.05)}}
.rank-circle{width:54px;height:54px;border-radius:9999px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:1.25rem;margin:6px auto}
.rank-1 .rank-circle{background:var(--shell-yellow);color:#000}
.rank-2 .rank-circle{background:#c0c0c0;color:#000}
.rank-3 .rank-circle{background:#cd7f32;color:#000}
.podium-name,.podium-institution{font-weight:800;font-size:1.7rem;line-height:1.3;margin:6px 0}
.podium-institution{color:#ffe6e6;opacity:.95}
.small-meta{font-size:1rem;color:#f7d9d9;margin-top:6px}
.podium-stats{margin-top:16px;padding-top:10px;border-top:1px solid rgba(255,255,255,.15);display:flex;justify-content:center;gap:14px}
.podium-stats .time{color:var(--shell-yellow);font-weight:900;font-size:1.15rem}
.winner-text{font-weight:900;font-size:32px;letter-spacing:1px;margin-top:6px;
  background:linear-gradient(90deg,var(--shell-yellow),#fff,var(--shell-yellow));
  background-clip:text;-webkit-background-clip:text;color:transparent;text-transform:uppercase;display:inline-block}

/* ====== Others Grid (4â€“5) ====== */
#othersGrid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-top:40px;animation:fadeInUp 1s ease both}
.other-card{background: var(--card-bg);border-radius:14px;padding:18px 20px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 10px 30px rgba(0,0,0,.5);font-size:1.15rem;opacity:0;transform:translateY(40px);animation:fadeInUp .8s ease forwards;border:1px solid rgba(255,215,0,0.1)}
@keyframes fadeInUp{0%{opacity:0;transform:translateY(40px)}100%{opacity:1;transform:translateY(0)}}
.other-card:nth-child(1){animation-delay:.2s}
.other-card:nth-child(2){animation-delay:.4s}
.other-rank{font-weight:900;font-size:1.4rem;width:60px;text-align:center;color:var(--shell-yellow)}

/* ===== Winner Zoom Overlay (Cinematic + Sunburst + Banner) ===== */
#winnerOverlay{
  position:fixed;inset:0;display:none;z-index:100;
  background:rgba(0,0,0,0.85);backdrop-filter:blur(22px);
  align-items:center;justify-content:center;transition:opacity .6s ease
}
#winnerOverlay.show{display:flex;animation:fadeInOverlay .5s ease forwards}
@keyframes fadeInOverlay{0%{opacity:0}100%{opacity:1}}
/* Sunburst rays behind the card during zoom */
.sunburst{
  position:absolute;inset:0;z-index:0;pointer-events:none;
  background:
    radial-gradient(closest-side, rgba(255,215,0,0.18), rgba(255,215,0,0.05) 60%, transparent 70%) center/60% 60% no-repeat,
    conic-gradient(from 0deg,
      rgba(255,215,0,0.15), rgba(255,215,0,0.00) 8%,
      rgba(255,215,0,0.15) 12%, rgba(255,215,0,0.00) 20%,
      rgba(255,215,0,0.15) 24%, rgba(255,215,0,0.00) 32%,
      rgba(255,215,0,0.15) 36%, rgba(255,215,0,0.00) 44%,
      rgba(255,215,0,0.15) 48%, rgba(255,215,0,0.00) 56%,
      rgba(255,215,0,0.15) 60%, rgba(255,215,0,0.00) 68%,
      rgba(255,215,0,0.15) 72%, rgba(255,215,0,0.00) 80%,
      rgba(255,215,0,0.15) 84%, rgba(255,215,0,0.00) 92%,
      rgba(255,215,0,0.15) 96%, rgba(255,215,0,0.00) 100%);
  animation:spinRays 18s linear infinite;opacity:.75;filter:blur(2px)
}
@keyframes spinRays{to{transform:rotate(360deg)}}

.zoomCard{position:relative;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;z-index:1}
.zoomInner{width:90vw;max-width:1600px;display:flex;justify-content:center;animation:zoomInRect 0.9s cubic-bezier(0.25,1,0.3,1)}
.zoomInner .podium-card{width:100%;max-width:100%;transform:scale(2.1);transform-origin:center;box-shadow:0 0 160px rgba(255,215,0,0.65);border-radius:18px}
@keyframes zoomInRect{from{transform:scale(0.5);opacity:0}to{transform:scale(1);opacity:1}}
/* Victory Banner */
.victory-banner{
  position:absolute;top:7%;left:50%;transform:translateX(-50%);
  font-weight:900;letter-spacing:0.12em;text-transform:uppercase;
  font-size:3.2rem;white-space:nowrap;
  background:linear-gradient(90deg,#fff,var(--shell-yellow),#fff);
  -webkit-background-clip:text;background-clip:text;color:transparent;
  text-shadow:0 0 20px rgba(255,215,0,0.25);
  opacity:0;animation:bannerIn .9s ease forwards .2s
}
@keyframes bannerIn{0%{transform:translate(-50%,-10px);opacity:0}100%{transform:translate(-50%,0);opacity:1}}

/* Canvas layers */
#confettiCanvas{position:fixed;inset:0;z-index:25;pointer-events:none}
#celebrationCanvas{position:fixed;inset:0;z-index:80;pointer-events:none}

@media (max-width:900px){
  #podiumContainer{flex-direction:column;align-items:center;gap:20px}
  #rank-1-card{width:90%;transform:none}
  #rank-2-card,#rank-3-card{width:80%;transform:none}
  #othersGrid{grid-template-columns:1fr}
  .victory-banner{font-size:2.2rem}
}
</style>
</head>

<body>
<div class="bg-pan"></div>
<div class="bg-ambient"></div>

<!-- Celebration layers -->
<canvas id="confettiCanvas"></canvas>
<canvas id="celebrationCanvas"></canvas>

<!-- Zoom overlay with sunburst + banner -->
<div id="winnerOverlay">
  <div class="sunburst"></div>
  <div id="zoomContent" class="zoomCard"></div>
  <div class="victory-banner" id="victoryBanner">ðŸŽ‰ CONGRATULATIONS!</div>
</div>

<main>
<header class="flex items-center gap-3">
  <img src="https://www.shell.com.ng/etc.clientlibs/amidala/clientlibs/theme-base/resources/favicon/favicon.svg" style="width:44px;height:44px;filter:drop-shadow(0 8px 18px rgba(255,215,0,.2))" alt="Shell logo"/>
  <div>
    <h1><span style="color:var(--shell-yellow)">Shell Booth</span> Puzzle Challenge â€” Leaderboard <span class="live-badge">LIVE</span></h1>
    <div id="lastUpdated" class="last-updated">Last updated: â€”</div>
  </div>
</header>

<section id="podiumContainer">
  <div id="rank-2-card" class="podium-card rank-2">
    <div class="rank-circle">2</div>
    <div class="podium-name" id="r2-name">â€”</div>
    <div class="podium-institution" id="r2-inst">â€”</div>
    <div class="small-meta" id="r2-achieved">Achieved: â€”</div>
    <div class="podium-stats"><div class="time" id="r2-time">â€”</div><div>|</div><div id="r2-moves">â€” moves</div></div>
  </div>

  <div id="rank-1-card" class="podium-card rank-1 gold-pulse">
    <img src="https://www.ripmark.com.ng/wp-content/uploads/2025/11/Gemini_Generated_Image_t6owfyt6owfyt6ow-removebg-preview.png" alt="Winner Gift Box" class="gift-box-img"/>
    <div class="winner-text">CURRENT TOP SOLVER</div>
    <div class="podium-name" id="r1-name">â€”</div>
    <div class="podium-institution" id="r1-inst">â€”</div>
    <div class="small-meta" id="r1-achieved">Achieved: â€”</div>
    <div class="podium-stats"><div class="time" id="r1-time">â€”</div><div>|</div><div id="r1-moves">â€” moves</div></div>
  </div>

  <div id="rank-3-card" class="podium-card rank-3">
    <div class="rank-circle">3</div>
    <div class="podium-name" id="r3-name">â€”</div>
    <div class="podium-institution" id="r3-inst">â€”</div>
    <div class="small-meta" id="r3-achieved">Achieved: â€”</div>
    <div class="podium-stats"><div class="time" id="r3-time">â€”</div><div>|</div><div id="r3-moves">â€” moves</div></div>
  </div>
</section>

<section style="margin-top:40px">
  <h2 style="text-align:center;font-size:1.8rem;font-weight:900;color:#002b45;margin-bottom:14px">Top Solvers (4â€“5)</h2>
  <div id="othersGrid"></div>
</section>
</main>

<script>
/* ====== Keep API logic intact ====== */
const SERVER_URL='https://shell-puzzle-api.onrender.com';

/* ====== CONFETTI (full-screen) ====== */
const confettiCanvas=document.getElementById('confettiCanvas'),ctx=confettiCanvas.getContext('2d');
function resizeConfetti(){confettiCanvas.width=innerWidth;confettiCanvas.height=innerHeight}
resizeConfetti();addEventListener('resize',resizeConfetti);

let particles=[];
function P(x,y,vx,vy,s,c,life,rot,type){this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.size=s;this.color=c;this.life=life;this.rot=rot||0;this.type=type||'confetti'}
P.prototype.update=function(){this.vy+=0.03;this.x+=this.vx;this.y+=this.vy;this.rot+=0.06;this.life-=1}
P.prototype.draw=function(){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.rot);ctx.globalAlpha=Math.max(this.life/260,0.08);
  if(this.type==='confetti'){
    ctx.fillStyle=this.color;ctx.fillRect(-this.size/2,-this.size/2,this.size,this.size*0.6)
  }else if(this.type==='balloon'){
    ctx.fillStyle=this.color;ctx.beginPath();ctx.ellipse(0,0,this.size/1.2,this.size*1.6,0,0,2*Math.PI);ctx.fill();
    ctx.beginPath();ctx.moveTo(0,this.size*1.6);ctx.lineTo(0,this.size*2.2);ctx.strokeStyle='rgba(255,255,255,0.5)';ctx.lineWidth=1;ctx.stroke();
  }else if(this.type==='logo'){
    drawPecten(ctx,this.size*1.2);
  }
  ctx.restore();ctx.globalAlpha=1
}
function burstFullScreen(){
  const cols=['#FFD700','#FFFFFF','#E30613','#FFC300'];
  for(let i=0;i<200;i++){
    const x=Math.random()*innerWidth,y=Math.random()*innerHeight,ang=Math.random()*Math.PI*2,sp=Math.random()*6+2;
    const tRand=Math.random();
    const t=tRand<0.12?'logo':(tRand<0.35?'balloon':'confetti');
    const s=(t==='logo')?(10+Math.random()*10):(4+Math.random()*10);
    particles.push(new P(x,y,Math.cos(ang)*sp,Math.sin(ang)*sp,s,cols[Math.floor(Math.random()*cols.length)],320+Math.random()*140,Math.random(),t));
  }
}
function draw(){ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height);
  for(let i=particles.length-1;i>=0;i--){const p=particles[i];p.update();p.draw();if(p.life<=0||p.y>innerHeight+80)particles.splice(i,1)}
  requestAnimationFrame(draw)
}
draw();setInterval(burstFullScreen,4500);

/* Stylized vector Shell Pecten for logo-confetti */
function drawPecten(ctx,size){
  const s=size;
  ctx.save();
  ctx.fillStyle='#FFD700';
  ctx.beginPath();ctx.moveTo(0,0);ctx.arc(0,0,s,Math.PI,0,false);ctx.closePath();ctx.fill();
  ctx.strokeStyle='rgba(255,255,255,0.9)';ctx.lineWidth=Math.max(1,s*0.08);
  const ribs=6;for(let i=0;i<=ribs;i++){const a=-Math.PI+(i*(Math.PI/ribs));const x=Math.cos(a)*s*0.95,y=Math.sin(a)*s*0.55;ctx.beginPath();ctx.moveTo(0,0);ctx.lineTo(x,y);ctx.stroke()}
  ctx.fillStyle='#E30613';ctx.fillRect(-s*0.25,s*0.05,s*0.5,s*0.28);
  ctx.restore();
}

/* ===== Ambient celebration (sparkles / balloons mix) ===== */
const celebrationCanvas=document.getElementById('celebrationCanvas'),cctx=celebrationCanvas.getContext('2d');
function resizeCelebration(){celebrationCanvas.width=innerWidth;celebrationCanvas.height=innerHeight}
resizeCelebration();addEventListener('resize',resizeCelebration);
const shapes=[];
function Shape(x,y,vx,vy,size,color,type){this.x=x;this.y=y;this.vx=vx;this.vy=vy;this.size=size;this.color=color;this.life=500+Math.random()*300;this.type=type}
function spawnCelebration(){
  const colors=['#FFD700','#FFFFFF','#E30613','#FFC300'];
  for(let i=0;i<100;i++){
    const x=Math.random()*innerWidth,y=Math.random()*innerHeight/2,vx=(Math.random()-0.5)*2,vy=(Math.random()-0.5)*2;
    const s=4+Math.random()*8,color=colors[(Math.random()*colors.length)|0];
    const tRand=Math.random();
    const t=tRand<0.10?'logo':(tRand<0.55?'spark':'balloon');
    shapes.push(new Shape(x,y,vx,vy,s,color,t));
  }
}
function drawCelebration(){
  cctx.clearRect(0,0,celebrationCanvas.width,celebrationCanvas.height);
  for(let i=shapes.length-1;i>=0;i--){
    const s=shapes[i];s.x+=s.vx;s.y+=s.vy;s.vy+=0.008;s.life--;
    cctx.globalAlpha=Math.max(s.life/800,0.12);
    if(s.type==='spark'){
      cctx.fillStyle=s.color;cctx.beginPath();cctx.arc(s.x,s.y,s.size/3,0,2*Math.PI);cctx.fill();
    }else if(s.type==='balloon'){
      cctx.fillStyle=s.color;cctx.beginPath();cctx.ellipse(s.x,s.y,s.size/1.3,s.size*1.8,0,0,2*Math.PI);cctx.fill();
      cctx.beginPath();cctx.moveTo(s.x,s.y+s.size*1.8);cctx.lineTo(s.x,s.y+s.size*2.2);cctx.strokeStyle='rgba(255,255,255,0.45)';cctx.stroke();
    }else if(s.type==='logo'){
      cctx.save();cctx.translate(s.x,s.y);cctx.rotate((s.life%360)/40);drawPecten(cctx,s.size*1.6);cctx.restore();
    }
    if(s.life<=0||s.y>innerHeight+60)shapes.splice(i,1);
  }
  cctx.globalAlpha=1;requestAnimationFrame(drawCelebration)
}
drawCelebration();setInterval(spawnCelebration,3800);spawnCelebration();

/* ===== Time + API (unchanged) ===== */
function fmt(ts){if(!ts)return'â€”';const n=Number(ts);const d=isNaN(n)?new Date(ts):new Date(n);return d.toLocaleString('en-NG',{dateStyle:'medium',timeStyle:'short',timeZone:'Africa/Lagos'})}
function updLU(){const el=document.getElementById('lastUpdated');if(el)el.textContent='Last updated: '+(new Date()).toLocaleString('en-NG',{timeZone:'Africa/Lagos'})}

async function load(){
  let s=[];
  try{
    const r=await fetch(`${SERVER_URL}/scores`);
    if(!r.ok)throw new Error();
    s=await r.json();
  }catch(e){s=[]}
  s.sort((a,b)=>a.time===b.time?(a.moves||0)-(b.moves||0):a.time-b.time);

  const clear=(x)=>['name','inst','time','moves','achieved'].forEach(k=>{const el=document.getElementById(`${x}-${k}`);if(el)el.textContent='â€”'});
  const fill=(p,x)=>{if(!p){clear(x);return}const[nm,inst]=(p.id||'Unknown â€” Unknown').split(' â€” ');
    document.getElementById(x+'-name').textContent=nm||'Unknown';
    document.getElementById(x+'-inst').textContent=inst||'';
    document.getElementById(x+'-time').textContent=(typeof p.time==='number')?p.time.toFixed(2)+'s':p.time;
    document.getElementById(x+'-moves').textContent=(p.moves||0)+' moves';
    document.getElementById(x+'-achieved').textContent='Achieved: '+(p.ts?fmt(p.ts):'â€”')
  };

  fill(s[0],'r1');fill(s[1],'r2');fill(s[2],'r3');

  const grid=document.getElementById('othersGrid');grid.innerHTML='';
  s.slice(3,5).forEach((p,i)=>{const rank=i+4;const[nm,inst]=(p.id||'Unknown â€” Unknown').split(' â€” ');
    const d=document.createElement('div');d.className='other-card';d.style.animationDelay=(i*0.2)+'s';
    d.innerHTML=`<div style="display:flex;gap:14px;align-items:center;">
        <div class="other-rank">#${rank}</div>
        <div><h4>${nm||'Unknown'}</h4><p>${inst||''}</p>
          <p style="font-size:.85rem;color:#FFD700;margin-top:6px">Achieved: ${p.ts?fmt(p.ts):'â€”'}</p></div>
      </div>
      <div style="text-align:right;">
        <div style="color:var(--shell-yellow);font-weight:900;">${(typeof p.time==='number')?p.time.toFixed(2)+'s':p.time}</div>
        <div style="color:#fff;font-size:.95rem">${p.moves||0} moves</div>
      </div>`;
    grid.appendChild(d)
  });

  updLU();
}
load();setInterval(load,15000);

/* ===== Winner Zoom (every minute) ===== */
function triggerWinnerZoom(){
  const w=document.getElementById('rank-1-card');if(!w)return;
  const overlay=document.getElementById('winnerOverlay');
  const z=document.getElementById('zoomContent');z.innerHTML='';

  // Clone winner card
  const clone=w.cloneNode(true);
  clone.style.width='100%';clone.style.maxWidth='100%';

  // Update banner to include winnerâ€™s name
  const nameEl=document.getElementById('r1-name');
  const banner=document.getElementById('victoryBanner');
  const winnerName=(nameEl && nameEl.textContent && nameEl.textContent.trim()!=='â€”')?nameEl.textContent.trim():'CURRENT TOP SOLVER';
  banner.textContent=`ðŸŽ‰ CONGRATULATIONS, ${winnerName}!`;

  const wrap=document.createElement('div');wrap.className='zoomInner';wrap.appendChild(clone);
  z.appendChild(wrap);
  overlay.classList.add('show');

  // Celebration bursts on zoom
  burstFullScreen();spawnCelebration();

  // auto close after 10s
  setTimeout(()=>{overlay.classList.remove('show');z.innerHTML='';},10000);
}
setInterval(triggerWinnerZoom,60000); // every 1 minute
</script>
</body>
</html>
